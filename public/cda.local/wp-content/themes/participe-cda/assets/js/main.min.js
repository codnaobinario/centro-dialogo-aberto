"use strict";function resize(){var a=$(window).height()-$(".navbar").height();$(".home_grid").height(a)}jQuery(function(){if($("input, textarea").placeholder(),$(".form-group.edit button").bind("click",function(){var a=$(this).siblings("input:text,input:password");a.attr("disabled",!a.attr("disabled"))}),$(".steps.voting").length){var s={total:12,current:1,votes:new Array(this.total),pts:{happy:3,neutral:2,unhappy:1,next:"x"},init:function(){$(".steps .footer .next, .emot a").bind("click",s.vote),$(".steps .footer .finish").bind("click",s.finish),$(".steps .footer .prev").bind("click",s.prev),s.load()},vote:function(){s.votes[s.current-1]=s.pts[this.className],s.next()},load:function(a){a=a||s.current;var b=$(".steps_content .step"+a).html();$(".step_content").html(b),$(".steps .footer .counter").text(s.current+"/"+s.total)},next:function(){s.current<=s.total&&s.current++,s.goToStep()},prev:function(){s.current--,s.goToStep()},goToStep:function(){var a=["prev","next","counter","step_content","emot"],b=["back","conclusion","finish"];s.current>s.total?(a=["finish","conclusion"],b=["next","counter","step_content","emot"]):1===s.current&&(a=["back"],b=["prev"]),$("."+a.join(",.")).show(),$("."+b.join(",.")).hide(),s.load()},finish:function(){window.location.href="../resultados?voting="+s.votes.join(",")}};s.init()}if($(".home_grid").length,jQuery(document).ready(function(){jQuery(".carousel").carousel({interval:1500})}),$(".proposta").length){var tabs=$(".content-header .tabs .tab a"),width=100/tabs.length-10;$(".carousel").carousel({interval:3e3}),$("#gallery2 .control").bind("click",function(){var a=$("#gallery2");a.hasClass("paused")?a.carousel("cycle").removeClass("paused"):a.carousel("pause").addClass("paused")}),$("#gallery2 .play span").bind("click",function(){});var userComent={open:function(){$(".user_comment").slideDown("fast"),$(".vote .quotes").addClass("selected"),$(".user_comment input:text").focus()},close:function(){$(".user_comment").slideUp("fast"),$(".vote .quotes").removeClass("selected")},toggle:function(){$(".vote .quotes").hasClass("selected")?userComent.close():userComent.open()}};$(".vote .quotes").bind("click",userComent.toggle);var vote=function(){var a=this.id,b=$(this).parent().hasClass("selected")?"dislike":"like",c=$(this).data("url"),d=$(this).parent().siblings(".up,.down"),e=$(this).children("p");$(this).parent().toggleClass("selected"),e.text("like"===b?parseInt(e.text())+1:parseInt(e.text())-1),$.post(c+"/"+a+"/"+b),d.hasClass("selected")&&(e=d.find("p"),e.text(parseInt(e.text())-1),d.removeClass("selected"),a="up"===a?"down":"up",$.post(c+"/"+a+"/dislike")),userComent.open()};$("#up,#down",".vote").bind("click",vote),$("form#comment").bind("submit",function(){var a=$(this),b=a.attr("action"),c=a.children("input:text");return $.ajax({type:"POST",url:b,data:{comment:c.val()},success:function(a){$(".no_comments").hide(),$(".comments .comments_wrapper").prepend('<div style="display: none;" class="comment user_hold"> <p class="comment_hold">Comentário aguardando aprovação</p> <p class="comment_author">'+a.comment_author+'</p> <p class="comment_time">Agora</p>  <p class="comment_title">'+a.comment_content+"</p></div>").children("div:first").fadeIn("slow"),userComent.close(),c.val("")},dataType:"json"}),!1})}if($(".edit_points").length){var map,img,points,pts,list,mapTop,mapLeft,PTS={init:function(){map=$(".map_zone"),list=map.data("points"),img=$("img",map),mapTop=parseInt($(".map_zone").position().top),mapLeft=parseInt($(".map_zone").position().left),pts=$(".map_zone .point"),PTS.load(),map.bind("click",PTS.mapClick)},load:function(){var a=list.split("l");a.shift(),$(a).each(function(a,b){PTS.plot(b.split("x"))})},mapClick:function(a){"map"===a.target.id?PTS.includePoint(a):PTS.removePoint(a)},includePoint:function(a){var b=a.clientX-mapLeft,c=a.clientY-mapTop,d=img.width(),e=img.height();b=Math.round(100*b/d),c=Math.round(100*c/e),PTS.plot([b,c]),list=list+"l"+b+"x"+c,PTS.updateDb()},removePoint:function(a){var b=a.target,c=$(b).data("coord");list=list.replace("l"+c,"l0x0"),PTS.updateDb(),$(b).remove()},plot:function(a){0!=a[0]&&0!=a[1]&&$(".points").append('<div class="pt pt_del" data-coord="'+a.join("x")+'" style="left:'+a[0]+"%;top:"+a[1]+'%"></div>')},update:function(){pts=$(".map_zone .point")},updateDb:function(){$.post(window.location.href.replace("edit_","update_").replace("?","")+list)}};PTS.init()}if($(".sugestao").length){var tab=$(".tab.selected").attr("id"),S={userPoints:data.usr,init:function(){"geral"!=tab&&S.setFixed(),$(".point",".map_zone .spots").bind("click",function(){$(this).hasClass("selected")?S.unselectSpot(this):S.selectSpot(this)}),$(".point",".points").bind("click",S.choosePoint),$(".info .create_my_map").bind("click",S.myMap.create),$(".info .finish_my_map").bind("click",S.myMap.finish),$(".info .edit_my_map").bind("click",S.myMap.edit),$(".info .publish_my_map").bind("click",S.myMap.publish)},setFixed:function(){var a=$(".fixo");a.each(function(){$(".spots ."+this.id.replace("point_","pt_")).addClass("fixed")})},selectSpot:function(a){if(!$(".tab_minha_sugestao").hasClass("finished")){$(".point",".map_zone .spots").removeClass("selected"),$(a).addClass("selected");var b=a.id.length?a.id.replace("pt_",""):null;S.selectInfo(b),S.selectPoint(b)}},unselectSpot:function(a){$(a).removeClass("selected"),S.unselectPoint(),S.unselectInfo()},selectPoint:function(a){return $(".spots .pt_"+a).hasClass("fixed")?void S.unselectPoint():($(".points").removeClass("disabled").addClass("enabled").find(".point").removeClass("selected"),void(a&&$(".points #point_"+a).addClass("selected")))},unselectPoint:function(){$(".points").removeClass("enabled").addClass("disabled").find(".point").removeClass("selected")},selectInfo:function(a){$(".point",".info").removeClass(),a?($(".point_info",".info").html($(".point_wrapper_"+a).html()),$(".point_info").show(),"geral"===tab&&S.selectVoting(a)):($(".point_info").hide(),$(".voting").hide())},unselectInfo:function(){$(".point_info").hide(),$(".voting").hide()},selectVoting:function(id){for(var index=$(".spots #pt_"+id).data("index")-1,total=eval(data.votesCount[index].join("+")),length=eval(data.votes[index].length),counts=[100*data.votes[index][0][1]/total,100*data.votes[index][1][1]/total,100*data.votes[index][2][1]/total],pts=[data.votes[index][0][0],data.votes[index][1][0],data.votes[index][2][0]],i=0;4>i;i++)$(".voting .vote"+(i+1)+" .pt").removeClass().addClass("pt pt_"+pts[i]).parent().siblings().find("span").css("width",counts[i]+"%");$(".voting").show()},choosePoint:function(){if(!$(".points").hasClass("disabled enabled")){var a=this.id.replace("point_",""),b=$(".point.selected",".map_zone .spots");if(!b.hasClass("fixed")){var c=b.data("index");S.userPoints[c]=a;var d=b[0].id;b.attr("id","pt_"+a).removeClass(d).addClass("pt_"+a),S.selectPoint(a),S.selectInfo(a),$.post(window.location.href.replace("sugestao/minha_sugestao","user_points")+S.userPoints.join("l"))}}},myMap:{create:function(){},finish:function(){$(".point.selected").removeClass("selected"),$(".tab_minha_sugestao").removeClass("editing").addClass("finished")},edit:function(){$(".tab_minha_sugestao").removeClass("finished").addClass("editing")},publish:function(){}}};S.init()}});
//# sourceMappingURL=main.min.map